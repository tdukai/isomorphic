"use strict";var RealUrl=function(){};RealUrl.prototype.parse=function(t){var o,e={};if(t=void 0===t?"undefined"!=typeof window?window.location.href:"":t){t.indexOf("?")>-1&&(o=t.split("?"),t=o[1]),t.indexOf("#")>-1&&(o=t.split("#"),t=o[0]),o=t.split("&");for(var n in o)if(o.hasOwnProperty(n)){var i=o[n].split("=");e[i[0]]=i[1]}}return e},RealUrl.prototype.getQueryValue=function(t,o){var e,n;if(o=void 0===o?"undefined"!=typeof window?window.location.href:"":o){n=this.parse(o);for(var i in n)if(n.hasOwnProperty(i)&&i===t){e=n[i];break}}return e},RealUrl.prototype.setQueryValue=function(t,o,e){e=void 0===e?"undefined"!=typeof window?window.location.href:"":e;var n,i,a=this.getQueryValue(t,e),s=e.indexOf("#")>-1?e.split("#")[1]:"",r=e.indexOf("?")>-1?"&":"?",d=e;return a&&a!==o&&t&&o?(n=[t,"=",a].join(""),i=[t,"=",o].join(""),d=d.replace(n,i)):void 0===a&&t&&o&&(""!==s&&(d=d.replace(s,"")),s=""===s?"":["#",s].join(""),d=[d,r,t,"=",o,s].join("")),d},RealUrl.prototype.host=function(t){var o=[window.location.protocol,"//",window.location.hostname,""===window.location.port?"":":",window.location.port];return t&&o.push(t),o.join("")},RealUrl.prototype.update=function(t,o){t=t||{},o=void 0===o?window.location.href:o;for(var e in t)t.hasOwnProperty(e)&&(o=this.setQueryValue(e,t[e],o));if("undefined"!=typeof window&&"undefined"!=typeof window.history&&window.history.pushState&&o){var n=o,i=window.location.href,a=this.host();-1===o.indexOf(a)&&(n=[a,"/"===o[0]?"":"/",o].join("")),n!==i&&window.history.pushState({path:n},"",n)}},window.move=window.move||{},window.move.RealUrl=RealUrl;var isBrowser="undefined"!=typeof window,isNode="undefined"!=typeof module&&"undefined"!=typeof module.exports,ContactsItemModel=function(t){t=t||{};for(var o in t)t.hasOwnProperty(o)&&(this[o]=t[o])};ContactsItemModel.prototype.initials=function(){var t="";return this.firstName&&(t+=this.firstName.substring(0,1).toUpperCase()),this.lastName&&(t+=this.lastName.substring(0,1).toUpperCase()),""===t&&(t="??"),t},ContactsItemModel.prototype.fullName=function(){var t="n/a";return this.firstName&&this.lastName&&(t=[this.firstName,this.lastName].join(" ")),t},ContactsItemModel.prototype.isInquiry=function(){return"INQUIRY"===this.mode},ContactsItemModel.prototype.isContact=function(){return"CONTACT"===this.mode},ContactsItemModel.prototype.displayDate=function(){var t;if(this.date){var o=new Date(this.date);t=o.toLocaleDateString()}return t},isBrowser?(window.move=window.move||{},window.move.ContactsItemModel=ContactsItemModel):isNode&&(module.exports=ContactsItemModel);var isBrowser="undefined"!=typeof window,isNode="undefined"!=typeof module&&"undefined"!=typeof module.exports,ContactsPagingModel=function(t){t=t||{},this.page=t.page?parseInt(t.page,10):0,this.size=t.size?parseInt(t.size,10):0,this.sort=t.sort||"",this.count=t.count||0};ContactsPagingModel.prototype.pageCount=function(){var t=this.count/this.size;if(this.count<=this.size)t=1;else{t=Math.floor(this.count/this.size);var o=this.count%this.size;o>0&&t++}return t},ContactsPagingModel.prototype.hasNext=function(){return this.page<this.count/this.size},ContactsPagingModel.prototype.hasPrev=function(){return this.page>1},ContactsPagingModel.prototype.next=function(){var t=!1;return this.page<this.pageCount()&&(this.page++,t=!0),t},ContactsPagingModel.prototype.prev=function(){var t=!1;return this.page>1&&(this.page--,t=!0),t},ContactsPagingModel.prototype.first=function(){return this.page=1,!0},ContactsPagingModel.prototype.last=function(){return this.page=this.pageCount(),!0},isBrowser?(window.move=window.move||{},window.move.ContactsPagingModel=ContactsPagingModel):isNode&&(module.exports=ContactsPagingModel);var isBrowser="undefined"!=typeof window,isNode="undefined"!=typeof module&&"undefined"!=typeof module.exports,ContactsItemModel=isNode?require("./contactsItemModel.js"):move.ContactsItemModel,ContactsDetailModel=function(t){ContactsItemModel.call(this,t),this.isDetail=!0};ContactsDetailModel.prototype=Object.create(ContactsItemModel.prototype),ContactsDetailModel.constructor=ContactsItemModel,ContactsDetailModel.prototype.addCommas=function(t){var o=/(\d+)(\d{3})/;for(t=void 0===t?0:t,t=t.toString();o.test(t);)t=t.replace(o,"$1,$2");return t},ContactsDetailModel.prototype.displayPrice=function(){var t="$n/a";return"number"==typeof this.price&&(t="$"+this.addCommas(this.price.toFixed(2))),t},ContactsDetailModel.prototype.displayBed=function(){var t="n/a";return"number"==typeof this.bed&&(t=this.bed.toString()),t},ContactsDetailModel.prototype.displayBath=function(){var t="n/a";return"number"==typeof this.bath&&(t=this.bath.toString()),t},ContactsDetailModel.prototype.displaySqft=function(){var t="n/a";return"number"==typeof this.sqft&&(t=this.addCommas(this.sqft)),t},isBrowser?(window.move=window.move||{},window.move.ContactsDetailModel=ContactsDetailModel):isNode&&(module.exports=ContactsDetailModel);var ContactsPage=function(t){var o,e,n,i,a,s,r,d,c,l,p,u,m,f,h,w,v,g,C=this,y=new move.RealAjax,M=null,P=null,x=new move.RealUrl,I=null,N={page:1,size:10,sort:"newest"};n=function(t){console&&console.error(t)},i=function(t){t.preventDefault(),t.stopPropagation(),alert("Not Implemented yet"),console&&console.log("Not Implemented yet")},a=function(){o="list",C.dom.detailContainer.hide(),C.dom.listContainer.show(),null!==M&&(x.update({},M),M=null),null!==I&&(C.dom.document.scrollTop(I),I=null)},s=function(){if(o="detail",I=C.dom.document.scrollTop(),"string"==typeof P){M=window.location.href;var t=x.host("/contact-detail/"+P);x.update({},t)}C.dom.listContainer.hide(),C.dom.detailContainer.show(),C.dom.document.scrollTop(0)},r=function(t,o){C.dom.menu=C.dom.menu||$("#widget--menu-widget"),null!==t?n(t):C.dom.menu.html("").append(o)},d=function(t,o){C.dom.contacts=C.dom.contacts||$("#contacts-items"),null!==t?n(t):C.dom.contacts.html("").append(o)},c=function(t,o){C.dom.detailContainer=C.dom.detailContainer||$("#detail-container"),null!==t?n(t):(C.dom.detailContainer.html("").append(o),s())},l=function(){x.update({page:e.page,size:e.size,sort:e.sort}),C.dom.sort.val(e.sort),C.dom.prev.hide(),e.hasPrev()&&C.dom.prev.show(),C.dom.next.hide(),e.hasNext()&&C.dom.next.show()},h=function(t,o){o=o||w;var e={page:t.page,size:t.size,sort:t.sort};y.post("/api/contacts/list",JSON.stringify(e),o,n)},w=function(t,o){if(t){e=null,e=new move.ContactsPagingModel(t.paging),C.cache.list=[];for(var n=0,i=t.contacts.length;i>n;n++)C.cache.list.push(new move.ContactsItemModel(t.contacts[n]));dust.render("contacts-list.dust",{contacts:C.cache.list},d),o?o():l()}else o&&o()},v=function(t,o){o=o||g,y.get("/api/contacts/detail/"+t,o,n)},g=function(t){if(t){var o=new move.ContactsDetailModel(t);C.cache.detail[o.id]=o,dust.render("contacts-detail.dust",o,c)}},p=function(){e.sort!==C.dom.sort.val()&&(e.sort=C.dom.sort.val(),h(e))},u=function(t){t.stopPropagation();var o=$(t.target),n=!1;o.hasClass("js-nav-next")?n=e.next():o.hasClass("js-nav-prev")&&(n=e.prev()),l(),n&&h(e)},m=function(t){t.stopPropagation();var o=$(t.target).parents("*[data-contact-id]").data("contact-id");void 0!==o&&""!==o&&(P=o,v(o))},f=function(t){t.preventDefault(),t.stopPropagation(),0===e.page&&0===e.size?h(N,function(t){w(t,function(){I=0,M=x.host("/contacts"),a(),l()})}):a()},C.options=t||{},C.dom={},C.cache={list:[],detail:{}},C.init=function(t){t=t||{},t.container=t.container||document,C.dom.container=C.dom.container||("string"==typeof t.container?$(t.container):t.container),dust.render("contacts-menu.dust",{},r),C.dom.document=C.dom.document||$(document),C.dom.container=C.dom.container||C.dom.document,C.dom.sort=C.dom.sort||$(".js-sort",C.dom.container),C.dom.next=C.dom.next||$(".js-nav-next",C.dom.container),C.dom.prev=C.dom.prev||$(".js-nav-prev",C.dom.container),C.dom.contacts=C.dom.contacts||$("#contacts-items",C.dom.container),C.dom.detailContainer=C.dom.detailContainer||$("#detail-container",C.dom.container),C.dom.listContainer=C.dom.listContainer||$("#list-container",C.dom.container),C.dom.sort.on("change",p),C.dom.next.on("click",u),C.dom.prev.on("click",u),C.dom.contacts.on("click","div",m),C.dom.document.on("click",".js-back-to-list",f),C.dom.document.on("click",".js-edit-contact",i),e=new move.ContactsPagingModel(t.paging),l()}};window.move=window.move||{},window.move.ContactsPage=ContactsPage;